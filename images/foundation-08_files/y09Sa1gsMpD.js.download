;/*FB_PKG_DELIM*/

__d("MJewelLinkFetcher",["$","DOM","MLinkHack"],(function(a,b,c,d,e,f,g){"use strict";function a(a){a=d("DOM").find(c("$")("MChromeHeader"),"div",a);if(!a)return null;a=d("DOM").find(a,"a","icon");return!a?null:d("MLinkHack").getHref(a)}g.get=a}),98);
__d("MJewelsSafePageletLoader",["MRequest","PageletEventConstsJS","PageletEventsHelper","Stratcom"],(function(a,b,c,d,e,f,g){"use strict";var h={};function i(a,b){var e=null,f=function(){e&&e.remove(),e=null};e=c("Stratcom").listen("m:page:unload",null,function(){f(),b()});d("PageletEventsHelper").subscribeToPageletEvents(function(b,d,e,g){b===a&&d===c("PageletEventConstsJS").JS_END&&f()})}function j(a,b){c("Stratcom").listen(["m:chrome:tab:show","m:jewel:flyout:open"],a,function(){new(c("MRequest"))(b).send(),c("Stratcom").removeCurrentListener()})}function a(a){if(h[a.jewelSigil])return;h[a.jewelSigil]=!0;i(a.pageletID,j.bind(null,a.jewelSigil,a.retryUri))}g.trackJewel=a}),98);
__d("onAfterDisplay",["NavigationMetrics","TimeSlice","requestIdleCallback"],(function(a,b,c,d,e,f,g){"use strict";var h=[],i=!1;function a(a){a=c("TimeSlice").guard(a,"onAfterDisplay invocation",{propagationType:c("TimeSlice").PropagationType.ORPHAN});i?c("requestIdleCallback")(a):h.push(a)}c("NavigationMetrics").addRetroactiveListener(c("NavigationMetrics").Events.EVENT_OCCURRED,function(a,b){["all_pagelets_displayed","e2e"].indexOf(b.event)>-1&&!i&&(i=!0,h.forEach(function(a){c("requestIdleCallback")(a)}))});g["default"]=a}),98);
__d("MFriendingJewelChannelUpdates",["ChannelEventType","MJewelSetLite","MJewels","MTouchChannelManagerBootloader","Stratcom"],(function(a,b,c,d,e,f,g){"use strict";var h=!1;function a(){if(h)return;h=!0;d("MTouchChannelManagerBootloader").init();c("Stratcom").listen(d("ChannelEventType").FRIEND_REQUESTS_COUNT,null,function(a){a=a.getData();var b=a.num_unseen;a=a.num_friend_confirmed_unseen;if(b==null||a==null)return;b=b+a;a=d("MJewelSetLite").getJewel(d("MJewels").REQUESTS);a.setBadgeCount(b)})}g.start=a}),98);
__d("MPageLoadClientMetricsCallbacks",["MHistory","NavigationMetrics","Run","Stratcom","SubscriptionsHandler"],(function(a,b,c,d,e,f,g){"use strict";var h=new(c("SubscriptionsHandler"))();function i(){h.release()}function j(b,d,e){return c("NavigationMetrics").addRetroactiveListener(c("NavigationMetrics").Events.EVENT_OCCURRED,function(f,g){if(f!==b)c("NavigationMetrics").removeCurrentListener();else if(g.event===d){f=a.MPageLoadClientMetrics.currentTimeToNavStartDelta(g.timestamp);a.MPageLoadClientMetrics.logEvent(e,f);c("NavigationMetrics").removeCurrentListener()}})}function b(b){if(!a.MPageLoadClientMetrics||!a.MPageLoadClientMetrics.isEnabled())return;a.MPageLoadClientMetrics.setDisableCallback(i);h.addSubscriptions(j(b.lid,"tti","tti"),j(b.lid,"e2e","e2e"),c("Stratcom").listen("m:page:load-start",null,function(b){if(b.getData().isFromHistory)return;a.MPageLoadClientMetrics.logEvent("navigation",a.MPageLoadClientMetrics.getMSFromNavStart(),a.MPageLoadClientMetrics.origin+b.getData().targetPath)}),c("Stratcom").listen("m:history:change",null,function(){var b=c("MHistory").getState();b=b?"soft="+b:c("MHistory").getPath();a.MPageLoadClientMetrics.logEvent("navigation",a.MPageLoadClientMetrics.getMSFromNavStart(),b)}));d("Run").onUnload(function(){a.MPageLoadClientMetrics.disable()})}g.init=b}),98);
__d("MBackToTop",["JavelinHistory","MHome","MPageController","MPageControllerPath","MStopNGo","MViewport","Stratcom"],(function(a,b,c,d,e,f){"use strict";var g=b("MViewport").getScreenHeight(),h={init:function(a){if(!h._isBrowserSupported())return;if(h._initialized)return;h._initialized=!0;h._reload=a.reload;b("MStopNGo").listen("go",h._pushScrollingStateIfNeeded);b("MStopNGo").listen("stop",function(){return setTimeout(h._pushScrollingStateIfNeeded,1e3)});b("Stratcom").listen("popstate",null,h._onpopstate)},_onpopstate:function(a){h._lastpop=Date.now();if(!h._isPathSupported())return;if(h._isScrollingState())return;b("MPageControllerPath").isRequestPath(location.href)&&b("MViewport").getScrollTop()>g&&(window.setTimeout(function(){b("MViewport").scrollToTop(),h._reload==="full"&&b("MPageController").reload()},1),a.stop())},_pushScrollingStateIfNeeded:function(){if(!h._isPathSupported())return;if(h._isScrollingState())return;b("MViewport").getScrollTop()>g&&Date.now()-h._lastpop>1e3&&window.history.pushState({scrolling:1},null)},_initialized:!1,_lastpop:0,_reload:null,_isScrollingState:function(){var a=window.history.state;return a&&a.scrolling},_isBrowserSupported:function(){return b("JavelinHistory").CAN_USE_PUSH_STATE},_isPathSupported:function(){return b("MHome").isHome(location.href)}};e.exports=h}),null);
__d("MLink",["CurrentEnvironment","DOM","ErrorUtils","FBLogger","MLegacyDataStore","MLinkHack","MLynx","MPageCache","MPageController","Stratcom","URI"],(function(a,b,c,d,e,f,g){var h="standalone"in window.navigator&&window.navigator.standalone,i=!1;function a(){if(i)return;i=!0;d("DOM").listen(document.documentElement,"click",null,function(a){if(a.getPrevented())return;c("ErrorUtils").applyWithGuard(function(){var b=a.getNode("tag:a");if(b==null)return;var e=a.getRawEvent();if(b.getAttribute("onclick")||(e.which||e.button)>=2)return;d("MLinkHack").remove(b);e=b.getAttribute("href")||null;var f=new(c("URI"))(e),g=f.getProtocol();if(g&&g!="http"&&g!="https")return;var i=f.getDomain(),j;c("CurrentEnvironment").workplacedotcom?j=i&&!/\.workplace.com$/i.test(i):j=i&&!/\.facebook.com$/i.test(i);j&&!d("MLynx").isShimmedLink(b)&&c("FBLogger")("FIXME").mustfix("Loading an external URL without shimming: %s",e);i=b.getAttribute("target")||null;if((i==="_blank"||j)&&h)return;if(b.hasAttribute("data-disable-mlink"))return;if(i==="_blank")window.open(e,"_blank");else if(f.getPath().toLowerCase().indexOf("/dialog/oauth")>-1)return;else if(i||g&&g+":"!==location.protocol||c("Stratcom").hasSigil(b,"no_mpc")||j)window.location=e;else if(e)if(e.indexOf("#")===0){f=document.getElementById(e.substr(1));f&&f.scrollIntoView()}else{i=d("MLegacyDataStore").get(b);i.fromCache&&c("MPageCache").setScrollHistory(e,0);d("MPageController").load(e,{replace:i.behavior==="replace-state",expiration:i.fromCache?i.shortCache?d("MPageController").EXPERIMENTAL_USER_EXPIRE_MS:d("MPageController").HISTORY_EXPIRE_MS:null,noAutoScroll:i.noAutoScroll,prefetchHref:i.prefetchHref,doNotRefocus:i.doNotRefocus})}else{if(b.hasAttribute("data-sigil"))return;g="";j=a.getTarget();while(j&&j!=document.body)g=g+" <"+j.nodeName,typeof j.id==="string"&&j.id!==""&&(g=g+" id="+j.id),typeof j.className==="string"&&j.className!==""&&(g=g+" class="+j.className),g+=" >",j=j.parentNode;c("FBLogger")("FIXME").warn('handleClick: unknown link action: <a id="%s" class="%s" /> Path: %s',b.id,b.className,g);return}a.prevent()},null,[],null,"LinkController")})}g.setupListener=a}),98);