;/*FB_PKG_DELIM*/

__d("MAnimation",["CSS","MLegacyDataStore","getVendorPrefixedName","setTimeoutAcrossTransitions"],(function(a,b,c,d,e,f,g){var h=c("getVendorPrefixedName")("animation-duration");function a(a,b,e){var f=d("MLegacyDataStore").get(a);window.clearTimeout(f.timerEnd);delete f.timerEnd;c("CSS").conditionClass(a,b,!1);c("CSS").conditionClass(a,"accelerate",!0);a.style[h]=e+"ms";f.timerStart=c("setTimeoutAcrossTransitions")(c("CSS").conditionClass.bind(null,a,b,!0),0);f.timerEnd=c("setTimeoutAcrossTransitions")(function(){c("CSS").conditionClass.bind(null,a,b,!1);a.style[h]="";c("CSS").conditionClass(a,"accelerate",!1);var e=d("MLegacyDataStore").get(a);window.clearTimeout(e.timerStart);delete e.timerStart},e)}g.animate=a}),98);
__d("MFriendingActionError",[],(function(a,b,c,d,e,f){a="confirm_incomming_request_error";b="delete_incomming_request_error";c="send_outgoing_request_error";d="cancel_outgoing_request_error";f.CONFIRM_INCOMING_REQUEST_ERROR=a;f.DELETE_INCOMING_REQUEST_ERROR=b;f.SEND_OUTGOING_REQUEST_ERROR=c;f.CANCEL_OUTGOING_REQUEST_ERROR=d}),66);
__d("MFriendingState",[],(function(a,b,c,d,e,f){a="m:friending-state:request-sent";b="m:friending-state:request-canceled";c="m:friending-state:unfriended";f.REQUEST_SENT=a;f.REQUEST_CANCELED=b;f.UNFRIENDED=c}),66);
__d("RegularPymkAddFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f,g){"use strict";a=c("getFalcoLogPolicy_DO_NOT_USE")("1744254");b=d("FalcoLoggerInternal").create("regular_pymk_add",a);e=b;g["default"]=e}),98);
__d("RegularPymkImpFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f,g){"use strict";a=c("getFalcoLogPolicy_DO_NOT_USE")("1744255");b=d("FalcoLoggerInternal").create("regular_pymk_imp",a);e=b;g["default"]=e}),98);
__d("RegularPymkProfileFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f,g){"use strict";a=c("getFalcoLogPolicy_DO_NOT_USE")("1744256");b=d("FalcoLoggerInternal").create("regular_pymk_profile",a);e=b;g["default"]=e}),98);
__d("RegularPymkXoutFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f,g){"use strict";a=c("getFalcoLogPolicy_DO_NOT_USE")("1744257");b=d("FalcoLoggerInternal").create("regular_pymk_xout",a);e=b;g["default"]=e}),98);
__d("MPymkFunnelLogger",["Event","RegularPymkAddFalcoEvent","RegularPymkImpFalcoEvent","RegularPymkProfileFalcoEvent","RegularPymkXoutFalcoEvent","Stratcom"],(function(a,b,c,d,e,f,g){function a(a,b,d){var e=a.getAttribute("data-pymk-id"),f=a.getAttribute("data-pymk-loc"),g=a.getAttribute("data-signature"),i=[];i.push(c("Event").listen(d,"click",function(){e!=null&&h(e,g,f)}));i.push(c("Event").listen(b,"click",function(){e!=null&&h(e,g,f)}));c("Stratcom").listen("m:page:unload",null,function(){c("Stratcom").removeCurrentListener();while(i.length)i.pop().remove()})}function b(a,b,d,e){c("RegularPymkImpFalcoEvent").logCritical(function(){return{pymk_id:a,pymk_location:d,pymk_signature:b,pymk_position:e}})}function d(a,b,d){c("RegularPymkXoutFalcoEvent").logCritical(function(){return{pymk_id:a,pymk_location:d,pymk_signature:b}})}function h(a,b,d){c("RegularPymkProfileFalcoEvent").logCritical(function(){return{pymk_id:a,pymk_location:d,pymk_signature:b}})}function e(a,b,d){c("RegularPymkAddFalcoEvent").logCritical(function(){return{pymk_id:a,pymk_location:d,pymk_signature:b}})}g.listenToProfileClick=a;g.logImpression=b;g.logXOut=d;g.logClick=h;g.logAdd=e}),98);
__d("XWriteAddFriendController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/a/friends/add/",{encrypted_id:{type:"String"},subject_id:{type:"IntOrPFBID"},how_found:{type:"String"},pymk_location:{type:"Enum",enumType:1},signature:{type:"Int",defaultValue:0},success_uri:{type:"String"},ref_param:{type:"String"},friending_list_id:{type:"Int"},ajax_id:{type:"String"},friending_location:{type:"String",defaultValue:""},link_to_profile:{type:"Bool",defaultValue:!0}})}),null);
__d("XWriteCancelFriendRequestController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/a/friendrequest/cancel/",{subject_id:{type:"IntOrPFBID"},cancel_ref:{type:"String"},redirect_uri:{type:"String"},force_redirect:{type:"Bool",defaultValue:!1},friending_list_id:{type:"Int"},show_inline_errors:{type:"Bool",defaultValue:!1},ajax_id:{type:"String"},friending_location:{type:"String"},link_to_profile:{type:"Bool",defaultValue:!0}})}),null);
__d("XWriteRemoveFriendController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/a/friends/remove/",{subject_id:{type:"Int"},unfriend_ref:{type:"String"}})}),null);
__d("MAddFriend",["csx","cx","DOM","MAnimation","MFriendingActionError","MFriendingState","MLegacyDataStore","MPageCache","MPageControllerPath","MPymkFunnelLogger","MRequest","MRequestTypes","MURI","Parent","Stratcom","XWriteAddFriendController","XWriteCancelFriendRequestController","XWriteRemoveFriendController","gkx"],(function(a,b,c,d,e,f,g,h,i){var j="m-add-friend",k="m-cancel-request",l="m-unfriend-request",m="m-unfollow-request",n="m-follow-request",o="check",p="friends",q="/a/subscriptions/remove",r="/a/subscriptions/add",s=86,t=224;function u(a){a=a.querySelector(".touched_hide");a&&d("MAnimation").animate(a,"_4-ic",500)}function v(){var a=c("MPageControllerPath").getRequestPath();c("MPageCache").removeCachedPage(a);c("MPageCache").clearCachedIUIResponses(a)}function w(a){var b=a.getNode(j),e=a.getNode("m-add-friend-secondary");if(b==null||!(b instanceof HTMLAnchorElement)||e==null)return;var f=d("MLegacyDataStore").get(b),g=d("MLegacyDataStore").get(e);C(a);d("MLegacyDataStore").set(e,{one_click_adding:!0,one_click_cancel_event:null});v();var h={id:f.id,hf:f.hf,pl:f.pl,fref:f.fref};f.floc&&(h.floc=f.floc);f.enc&&(h.enc=f.enc);var i=c("DOM").find(e,"*",o),k=c("DOM").find(e,"div","m-add-friend-flyout");f=new(c("MURI"))(c("XWriteAddFriendController").getURIBuilder().getURI());var l=new(c("MURI"))(b.href).getQueryData()._ft_;l&&f.addQueryData({_ft_:l});l=new(c("MURI"))(b.href).getQueryData().__xts__;l&&f.addQueryData({__xts__:l});b=new(c("MRequest"))(f.toString()).setType(d("MRequestTypes").DEPENDENT);b.setData(h);var m=function(){c("DOM").show(i),d("MLegacyDataStore").get(e).bounce&&u(i),c("Stratcom").listen("friending_state_change",null,x.bind(a,h.id,d("MFriendingActionError").SEND_OUTGOING_REQUEST_ERROR)),c("Stratcom").invoke(d("MFriendingState").REQUEST_SENT,null,{event:a,userid:h.id})};b.listen("start",function(){d("MLegacyDataStore").set(e,{outgoing_request_pending:!0}),c("DOM").hide(k),m()});b.listen("postprocess",function(a){d("MLegacyDataStore").set(e,{outgoing_request_pending:!1}),g.one_click_adding&&(d("MLegacyDataStore").set(e,{one_click_adding:!1}),g.one_click_cancel_event&&z(g.one_click_cancel_event))});b.send();a.kill()}function x(a,b,e){e=e.getData();if(e.userid!=a)return;if(e.error!=b)return;a=this.getNode("m-add-friend-secondary");if(e.error===d("MFriendingActionError").SEND_OUTGOING_REQUEST_ERROR&&a!=null){d("MLegacyDataStore").set(a,{outgoing_request_pending:!1});b=c("DOM").find(a,"*",o);var f=c("DOM").find(a,"div","m-add-friend-flyout");c("DOM").show(f);c("DOM").hide(b);c("Stratcom").invoke(d("MFriendingActionError").SEND_OUTGOING_REQUEST_ERROR,null,{event:this})}else if(e.error===d("MFriendingActionError").CANCEL_OUTGOING_REQUEST_ERROR){f=c("DOM").find(a,"a","m-cancel-request");b=c("DOM").find(a,"div","m-add-friend-flyout");c("DOM").show(f);c("DOM").hide(b);c("Stratcom").invoke(d("MFriendingActionError").CANCEL_OUTGOING_REQUEST_ERROR,null,{event:this})}c("Stratcom").removeCurrentListener()}function y(a){var b=d("MLegacyDataStore").get(a.getNode(l)),e=b.flyoutEvent;v();a=e.getNode("undoable-action");a||(a=e.getNode("m-add-friend-secondary"));var f=c("DOM").scry(a,"*",p)[0],g=c("DOM").find(a,"div","m-add-friend-flyout");a=c("XWriteRemoveFriendController").getURIBuilder().getURI();a=new(c("MRequest"))(a);a.setData({friend_id:b.id,noReload:!0,unref:b.unfriend_ref});a.listen("start",function(){c("DOM").hide(f),b.is_deactivated||c("DOM").show(g)});a.listen("done",function(a){if(a==null?void 0:(a=a.payload)==null?void 0:a.success){c("Stratcom").invoke(d("MFriendingState").UNFRIENDED,null,{event:e,userid:b.id});return}b.is_deactivated||c("DOM").hide(g);c("DOM").show(f)});a.send();e.kill()}function z(a){var b=d("MLegacyDataStore").get(a.getNode(k)),e=a.getNode("undoable-action");e||(e=a.getNode("m-add-friend-secondary"));e||(e=b.parentNode);var f=c("DOM").scry(e,"*",o)[0],g=c("DOM").find(e,"*","load"),h=c("DOM").find(e,"div","m-add-friend-flyout");e=a.getNode("m-add-friend-secondary");var i=e?d("MLegacyDataStore").get(e):null;if(F&&i&&i.outgoing_request_pending)return;if(i&&i.one_click_adding){d("MLegacyDataStore").set(e,{one_click_cancel_event:a});c("DOM").hide(f);c("DOM").show(g);return}var j=function(){d("MLegacyDataStore").get(h).not_friendable||c("DOM").show(h),c("Stratcom").invoke(d("MFriendingState").REQUEST_CANCELED,null,{event:a,userid:b.id})};i=c("XWriteCancelFriendRequestController").getURIBuilder().getURI();e=new(c("MRequest"))(i);e.setData({subject_id:b.id,ref_param:b.ref_param,floc:b.floc});c("Stratcom").listen("friending_state_change",null,x.bind(a,b.id,d("MFriendingActionError").CANCEL_OUTGOING_REQUEST_ERROR));e.listen("start",function(){c("DOM").hide(f),c("DOM").show(g)});e.listen("finally",function(){c("DOM").hide(g);j();var b=a.getNode("story-wrap");b&&d("MLegacyDataStore").set(b,{sent:!1})});e.send();a.kill()}function A(a){var b=a.getNode(m);if(b==null)return;b=d("MLegacyDataStore").get(b);var e=new(c("MURI"))(q);e=new(c("MRequest"))(e);var f=a,g=null;try{var h;g=(h=b.flyoutEvent)==null?void 0:h.getNode("popup-action-trigger")}catch(a){g=null}if(g!=null){e.setData({subject_id:b.id,forceredirect:!1,location:s});e.send();d("MLegacyDataStore").set(g,{is_following:!1});a.kill();return}h=f.getNode("m-add-friend-flyout");var i=c("DOM").find(h,"a","m-follow-request"),j=c("DOM").find(h,"a","m-unfollow-request"),k=c("DOM").find(h,"*","load");e.setData({subject_id:b.id,forceredirect:!1,location:t});e.listen("start",function(){c("DOM").hide(j),c("DOM").show(k)});e.listen("finally",function(){c("DOM").hide(k),c("DOM").show(i)});e.send();f.kill()}function B(a){var b=a.getNode(n);if(b==null)return;b=d("MLegacyDataStore").get(b);var e=new(c("MURI"))(r);e=new(c("MRequest"))(e);var f=a,g=null;try{var h;g=(h=b.flyoutEvent)==null?void 0:h.getNode("popup-action-trigger")}catch(a){g=null}if(g!==null){e.setData({subject_id:b.id,forceredirect:!1,location:s});e.send();d("MLegacyDataStore").set(g,{is_following:!0});a.kill();return}h=f.getNode("m-add-friend-flyout");var i=c("DOM").find(h,"a","m-follow-request"),j=c("DOM").find(h,"a","m-unfollow-request"),k=c("DOM").find(h,"*","load");e.setData({subject_id:b.id,forceredirect:!1,location:t});e.listen("start",function(){c("DOM").hide(i),c("DOM").show(k)});e.listen("finally",function(){c("DOM").hide(k),c("DOM").show(j)});e.send();f.kill()}function C(a){a=a.getNode(j);if(!a)return;a=d("Parent").bySelector(a,"._5pxa");if(!a)return;var b=a.getAttribute("data-pymk-id"),c=a.getAttribute("data-pymk-loc");a=a.getAttribute("data-signature");b!=null&&Boolean(b)&&c!=null&&(c==="/find-friends/index.php"||c==="mobile_jewel")&&a!=null&&d("MPymkFunnelLogger").logAdd(b,a,c)}var D=!1,E=!1,F=!1;function a(a){a!=null&&a&&!E&&(E=!0,c("Stratcom").listen("click",m,A),c("Stratcom").listen("click",n,B));if(D)return;D=!0;F=c("gkx")("832605");c("Stratcom").listen("click",j,w);c("Stratcom").listen("click",k,z);c("Stratcom").listen("click",l,y)}g.main=a}),98);